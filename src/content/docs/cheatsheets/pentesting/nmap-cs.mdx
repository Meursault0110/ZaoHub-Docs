---
title: Nmap Cheatsheet
description: A comprehensive guide to Nmap scanning and network discovery
template: doc
---

import { Steps, Tabs, TabItem } from '@astrojs/starlight/components';

## Table of Contents

- [Basic Scanning](#basic-scanning)
- [Port Scanning](#port-scanning)
- [Host Discovery](#host-discovery)
- [Service Detection](#service-detection)
- [OS Detection](#os-detection)
- [Timing and Performance](#timing-and-performance)
- [Output Formats](#output-formats)
- [Advanced Techniques](#advanced-techniques)

## Basic Scanning

<Steps>
1. **Simple Scans**
   ```bash
   nmap target                # Basic scan of a target
   nmap 192.168.1.1          # Scan single IP
   nmap 192.168.1.1/24       # Scan entire subnet
   nmap scanme.nmap.org      # Scan domain
   ```

2. **Multiple Targets**
   ```bash
   nmap 192.168.1.1 192.168.1.2     # Multiple IPs
   nmap 192.168.1.1-50              # IP range
   nmap -iL targets.txt             # Targets from file
   ```
</Steps>

## Port Scanning

<Tabs>
  <TabItem label="Scan Types">
    ```bash
    nmap -sS target          # SYN scan (default)
    nmap -sT target          # TCP connect scan
    nmap -sU target          # UDP scan
    nmap -sA target          # ACK scan
    nmap -sW target          # Window scan
    nmap -sM target          # Maimon scan
    ```
  </TabItem>

  <TabItem label="Port Selection">
    ```bash
    nmap -p 80 target        # Scan specific port
    nmap -p 80-443 target    # Port range
    nmap -p- target          # All ports (1-65535)
    nmap -F target           # Fast scan (100 ports)
    nmap --top-ports 1000    # Top 1000 ports
    ```
  </TabItem>
</Tabs>

## Host Discovery

```bash
nmap -sn target             # Ping scan (disable port scan)
nmap -Pn target            # Skip ping (assume host is up)
nmap -PS target            # TCP SYN ping
nmap -PA target            # TCP ACK ping
nmap -PU target            # UDP ping
nmap -PR target            # ARP ping
```

## Service Detection

<Steps>
1. **Version Detection**
   ```bash
   nmap -sV target           # Detect service versions
   nmap -sV --version-light  # Faster version detection
   nmap -sV --version-all    # Try all probes
   ```

2. **Script Scanning**
   ```bash
   nmap -sC target          # Default script scan
   nmap --script=vuln       # Vulnerability scripts
   nmap --script=safe       # Safe scripts only
   nmap --script=auth       # Authentication scripts
   ```
</Steps>

## OS Detection

<Tabs>
  <TabItem label="Basic OS Detection">
    ```bash
    nmap -O target           # OS detection
    nmap -O --osscan-guess  # Aggressive OS guess
    nmap -A target          # Enable OS detection, version detection, script scanning, and traceroute
    ```
  </TabItem>

  <TabItem label="Advanced Options">
    ```bash
    nmap -O --max-os-tries 1  # Limit OS detection tries
    nmap -O --osscan-limit    # Limit OS detection to promising targets
    ```
  </TabItem>
</Tabs>

## Timing and Performance

```bash
nmap -T0 target            # Paranoid timing (slow)
nmap -T1 target            # Sneaky timing
nmap -T2 target            # Polite timing
nmap -T3 target            # Normal timing (default)
nmap -T4 target            # Aggressive timing
nmap -T5 target            # Insane timing (fast)
```

## Output Formats

<Steps>
1. **Basic Output**
   ```bash
   nmap -oN output.txt      # Normal output
   nmap -oG output.txt      # Grepable output
   nmap -oX output.xml      # XML output
   nmap -oA output          # Output in all formats
   ```

2. **Special Formats**
   ```bash
   nmap -v target           # Verbose output
   nmap -vv target          # Very verbose output
   nmap --reason            # Display reason for state
   ```
</Steps>

## Advanced Techniques

<Tabs>
  <TabItem label="Firewall Evasion">
    ```bash
    nmap -f target           # Fragment packets
    nmap --mtu 24 target     # Use specific MTU
    nmap -D RND:10 target    # Decoy scan
    nmap --spoof-mac 0       # MAC address spoofing
    ```
  </TabItem>

  <TabItem label="Advanced Options">
    ```bash
    nmap --data-length 200   # Append random data
    nmap --max-retries 1     # Limit retry attempts
    nmap --min-rate 300      # Minimum packet rate
    nmap --max-parallelism 1 # Limit parallel probes
    ```
  </TabItem>
</Tabs>

## Best Practices

- Always ensure you have permission to scan the target
- Start with less intrusive scans
- Use appropriate timing templates
- Save scan results for documentation
- Be mindful of network bandwidth
- Avoid aggressive scanning on production systems

## Common Scanning Workflows

<Steps>
1. **Initial Reconnaissance**
   - Start with ping scan (-sn)
   - Follow with basic port scan
   - Run service detection on open ports
   - Save results for analysis

2. **Security Assessment**
   - Begin with stealthy scan (-T2)
   - Run version detection (-sV)
   - Execute relevant NSE scripts
   - Document all findings

3. **Quick Network Audit**
   - Use fast scan (-F)
   - Enable version detection (-sV)
   - Run default scripts (-sC)
   - Export results (-oA)
</Steps>

## Security Considerations

- Obtain proper authorization before scanning
- Avoid excessive scanning of sensitive services
- Be aware of local network security policies
- Monitor system logs during scanning
- Consider the impact on target systems
- Use appropriate scan timing for the environment